---
title: "LAB 4 - PARTE 2"
author: "Anne Gabriele Arcanjo"
date: "7/4/2019"
output: slidy_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(GGally)
library(ggfortify)
library(broom)
library(vroom)
library(gridExtra)
```

## Sobre os dados a serem descritos

Fonte dos dados:
- IDH Mundial http://hdr.undp.org/en/composite/HDI (2017)
- Indice de Liberdade https://www.heritage.org/index/excel/2019/index2019_data.xls (2019)


## Captura dos dados
```{r}
index2019_hdi2017_data = read_csv(here::here("data/index2019_hdi2017_data.csv"),
                                  col_types = "cccccccccccccccccccccccccccccccccccccccc")

dados_selecionados = index2019_hdi2017_data %>% select(1,3,4,5,6,14,15,16,30,35,36,37,39)
dados_selecionados = dados_selecionados %>% 
  filter(`World Rank` !=  "N/A")

dados_analisados <- data_frame(
  ID = as.double(dados_selecionados$CountryID),
  pais = dados_selecionados$WEBNAME,
  regiao = dados_selecionados$Region,
  rank_liberdade = as.double(dados_selecionados$`World Rank`),
  rank_liberdade_regiao = as.double(dados_selecionados$`Region Rank`),
  liberdade_empreender = as.double(dados_selecionados$`Business Freedom`),
  liberdade_trabalho = as.double(dados_selecionados$`Labor Freedom`),
  liberdade_monetaria = as.double(dados_selecionados$`Monetary Freedom`),
  pib_per_capita = as.double(dados_selecionados$`GDP per Capita (PPP)`),
  idh = as.double(dados_selecionados$hdi),
  rank_idh = as.double(dados_selecionados$hdi_rank),
  expectativa_vida = as.double(dados_selecionados$life_expenctancy),
  expectativa_media_estudos = as.double(dados_selecionados$mean_years_schooling)
  )
```
## Ajuste dos Dads
```{r}
dados_analisados$pib_per_capita = log(dados_analisados$pib_per_capita)
```

## Visualizações - RANK DE LIBERADE

```{r}
liberdade_pib = dados_analisados %>% 
    ggplot(aes(x = rank_liberdade, y = pib_per_capita )) +
    labs(title = "Classificação em Liberdade Econômica dado o GDP per Capita ", x = "Posição no Rank de Liberdade", y = "PIB per capita ") +
    geom_count(alpha = .5)

liberdade_idh = dados_analisados %>% 
    ggplot(aes(x = rank_liberdade, y = idh )) +
    labs(title = "Classificação em Liberdade Econômica dado o IDH ", x = "Posição no Rank de Liberdade", y = "IDH") +
    geom_count(alpha = .5)

grid.arrange(liberdade_pib, liberdade_idh, ncol=2)

```

## Business Freedom
#### Liberdade para Empreender

É um indicador geral da eficiência da regulamentação governamental de negócios. A pontuação quantitativa é derivada de uma matriz de medidas da dificuldade de iniciar, operar e fechar um negócio. A pontuação de liberdade de negócios para cada país é um número entre 0 e 100, com 100 igualando-se ao ambiente de negócios mais livre. A pontuação é baseada em 10 fatores, todos ponderados de forma igual, usando dados do estudo Doing Business do Banco Mundial:

- Iniciar um negócio - procedimentos (número);
- Começar um negócio - tempo (dias);
- Iniciando um negócio - custo (% da renda per capita);
- iniciar um negócio - capital mínimo (% da renda per capita);
- Obtenção de uma licença - procedimentos (número); 1
- Obtenção de uma licença - tempo (dias);
- Obtenção de uma licença - custo (% da renda per capita);
- Fechando um negócio - tempo (anos);
- Fechamento de um negócio - custo (% da renda); e
- Fechamento de um negócio - taxa de recuperação (centavos por dólar) .2

Para mais detalhes sobre a formulação dos dados:
https://www.heritage.org/index/business-freedom

## Visualizações - LIBERDADE PARA EMPREENDER

```{r}
mercado_pib = dados_analisados %>% 
    ggplot(aes(x = liberdade_empreender, y = pib_per_capita )) +
    labs(title = "GDP per Capita dado a Liberdade para Empreender", x = "Liberdade de Mercado (%)", y = "PIB per capita ") +
    geom_count(alpha = .5)

mercado_idh = dados_analisados %>% 
    ggplot(aes(x = liberdade_empreender, y = idh )) +
    labs(title = "IDH dado a Liberdade para Empreender", x = "Liberdade de Mercado (%)", y = "IDH") +
    geom_count(alpha = .5)

grid.arrange(mercado_pib, mercado_idh, ncol=2)

```

## Labor Freedom
#### Liberdade de Trabalho

O componente de liberdade trabalhista é uma medida quantitativa que considera vários aspectos do arcabouço legal e regulatório do mercado de trabalho de um país, incluindo regulamentações relativas a salários mínimos, leis que inibem demissões, exigências de demissão e restrições normativas mensuráveis na contratação e horas trabalhadas.

Seis fatores quantitativos são igualmente ponderados, cada um contado como um sexto do componente de liberdade de trabalho:

- Rácio do salário mínimo para o valor acrescentado médio por trabalhador,
- impedimento de contratar trabalhadores adicionais,
- rigidez de horas,
- Dificuldade de demitir funcionários redundantes,
- Período de notificação legalmente obrigatório e
- indenização compulsória.

Para mais detalhes sobre a formulação dos dados:
https://www.heritage.org/index/labor-freedom

## Visualizações - LIBERDADE DE TRABALHO

### GDP per Capita e IDH dado a Liberdade de Trabalho
```{r}
trabalho_pib = dados_analisados %>% 
    ggplot(aes(x = liberdade_trabalho, y = pib_per_capita )) +
    labs(x = "Liberdade de Trabalho (%)", y = "PIB per capita ") +
    geom_count(alpha = .5)

trabalho_idh = dados_analisados %>% 
    ggplot(aes(x = liberdade_trabalho, y = idh )) +
    labs(x = "Liberdade de Trabalho (%)", y = "IDH") +
    geom_count(alpha = .5)

grid.arrange(trabalho_pib, trabalho_idh, ncol=2)
```

## Monetary Freedom

#### Liberdade de Monetária

A liberdade monetária combina uma medida de estabilidade de preços com uma avaliação dos controles de preços. Tanto a inflação quanto os controles de preços distorcem a atividade do mercado. Estabilidade de preços sem intervenção microeconômica é o estado ideal para o livre mercado.

A pontuação para o componente liberdade monetária é baseada em dois fatores:

- A taxa de inflação média ponderada para os três anos mais recentes e
- Controles de preço.

Para mais detalhes sobre a formulação dos dados:
https://www.heritage.org/index/monetary-freedom

## Visualizações - LIBERDADE MONETÁRIA

### GDP per Capita e IDH dado a Liberdade Monetária

```{r}
monetaria_pib = dados_analisados %>% 
    ggplot(aes(x = liberdade_monetaria, y = pib_per_capita )) +
    labs(x = "Liberdade de Monetária (%)", y = "PIB per capita ") +
    geom_count(alpha = .5)

monetaria_idh = dados_analisados %>% 
    ggplot(aes(x = liberdade_monetaria, y = idh )) +
    labs(x = "Liberdade de Monetária (%)", y = "IDH") +
    geom_count(alpha = .5)

grid.arrange(monetaria_pib, monetaria_idh, ncol=2)
```

## Visualizações - EXPECTATIVA MÉDIA DE ANOS DE ESTUDO

### GDP per Capita e IDH dado a Expectativa Média de Anos de Estudo

```{r}
estudo_pib = dados_analisados %>% 
    ggplot(aes(x = expectativa_media_estudos, y = pib_per_capita )) +
    labs(x = "Anos de Estudo (média)", y = "PIB per capita ") +
    geom_count(alpha = .5)

estudo_idh = dados_analisados %>% 
    ggplot(aes(x = expectativa_media_estudos, y = idh )) +
    labs(x = "Anos de Estudo (média)", y = "IDH") +
    geom_count(alpha = .5)

grid.arrange(estudo_pib, estudo_idh, ncol=2)
```

## Visualizações - EXPECTATIVA VIDA

### GDP per Capita e IDH dado a Expectativa de Vida

```{r}
vida_pib = dados_analisados %>% 
    ggplot(aes(x = expectativa_vida, y = pib_per_capita )) +
    labs(x = "Expectiva de Vida (Anos)", y = "PIB per capita ") +
    geom_count(alpha = .5)

vida_idh = dados_analisados %>% 
    ggplot(aes(x = expectativa_vida, y = idh )) +
    labs(x = "Expectiva de Vida (Anos)", y = "IDH") +
    geom_count(alpha = .5)

grid.arrange(vida_pib, vida_idh, ncol=2)
```

## Geração de Modelos

```{r}
modelo_pib <- lm(pib_per_capita ~ rank_liberdade + liberdade_empreender +liberdade_trabalho + liberdade_monetaria + expectativa_media_estudos + expectativa_vida , data = dados_analisados)

tidy(modelo_pib,
     conf.int = TRUE,
     conf.level = 0.95)
```

```{r}
modelo_idh <- lm(idh ~ rank_liberdade + liberdade_empreender +liberdade_trabalho + liberdade_monetaria + expectativa_media_estudos + expectativa_vida , data = dados_analisados)

tidy(modelo_idh,
     conf.int = TRUE,
     conf.level = 0.95)
```