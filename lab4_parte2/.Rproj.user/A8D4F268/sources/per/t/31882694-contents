---
title: "LAB 4 - PARTE 1"
author: "Anne Gabriele"
output:
    html_document:
    df_print: paged
theme: sandstone
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
source(here::here("code/lib.R"))
library(GGally)
library(ggfortify)
library(broom)
require(ISLR)
library(modelr) # devtools::install_github("hadley/modelr")
theme_set(theme_bw())
```

```{r read}
atividade = read_projectdata()
```

Sua tarefa é agora criar dois modelos usando regressão linear múltipla, com as transformações que forem necessárias nas variáveis, para responder:

### Definição de termos

*características* - qual a casa (senado/câmara) do parlamentar, quantas pessoas ele segue, por quantas ele é seguido, quanto ele tuíta e quanto ele retuíta.

### Ajusde dos dados

```{r}
# Filtrado dados daqueles que possuem twitter ativo
dados_ajustados = atividade %>%
  filter(!is.na(seguidores)) %>%
  filter(engaj_total != 0)

# Dado a grande presença de valores iguais a 0 dentre as observações, a normalização dos dados foi feita pelo o log na base 10 das variáveis somadas em 1 
dados_ajustados$log_seguidores = log(dados_ajustados$seguidores + 1)
dados_ajustados$log_segue = log(dados_ajustados$segue + 1)
dados_ajustados$log_engaj_total = log(dados_ajustados$engaj_total + 1)
dados_ajustados$log_engaj_mediano = log(dados_ajustados$engaj_mediano + 1)
dados_ajustados$log_n_proprio = log(dados_ajustados$n_proprio + 1)
dados_ajustados$log_n_retweet = log(dados_ajustados$n_retweet+ 1)

```

### Questão 1
Qual a relação entre as características da atuação do parlamentar e o *engajamento total* que ele obtém no twitter?

#### Visualização da Correlação Dados
```{r}
dados_ajustados %>% 
    ggplot(aes(x = casa, y = log_engaj_total)) +
    labs(title = "Engajamento Total pelo Número de Seguidores") +
    geom_count()

dados_ajustados %>% 
    ggplot(aes(x = log_seguidores, y = log_engaj_total)) +
    labs(title = "Engajamento Total pelo Número de Seguidores") +
    geom_count()

dados_ajustados %>% 
    ggplot(aes(x = log_segue, y = log_engaj_total)) +
    labs(title = "Engajamento Total pelo Número de Seguidos") +
    geom_count()

dados_ajustados %>% 
    ggplot(aes(x = log_n_proprio, y = log_engaj_total)) +
    labs(title = "Engajamento Total pelo Número de Tweets") +
    geom_count()

dados_ajustados %>% 
    ggplot(aes(x = log_n_retweet, y = log_engaj_total)) +
    labs(title = "Engajamento Total pelo Número de Retweets") +
    geom_count()

```

```{r}
# Modelo: Engajamento total dado a casa, segue, seguidores, tweets, retweets.

modelo_1 <- lm(log_engaj_total ~ casa + log_seguidores + log_segue + log_n_proprio + log_n_retweet, data = dados_ajustados)

tidy(modelo_1,
     conf.int = TRUE,
     conf.level = 0.95)
glance(modelo_1)
```
#### Análise
Regressão linear múltipla foi utilizada para analisar a associação entre as variávies INDEPENDENTES *casa*, *número de seguidores*, *número de seguidos*, *número de tweets* e *número de retweets* com cada variável DEPENDENTE *engajamento total*.

Os resultados da regressão indicam que para o modelo:

##### MODELO 1 :
  engajamento total = -0,09 + (casaSENADO x 0,30)  + (seguidores x 0.55) + (segue x -0,26) + (tweets x 0,69) + (retweets x 0,94)
  
A determinação da *casa*, afeta em 0,30 unidades quando a variável tem valor "SENADO", o valor da VarDep Engajamento Total.

O ganho de 1 *seguidor* produz um ACRÉSCIMO de 0,55 o valor da VarDep Engajamento Total.

*Seguir* um novo usúario produz um DESCRÉSCIMO de 0,26 o valor da VarDep Engajamento Total.

A cada novo *tweet*, existe um aumento de 0,69 no valor da VarDep Engajamento Total.

A cada novo *retweet*, existe um aumento de 0,94 no valor da VarDep Engajamento Total.

### Questão 2
Qual a relação entre as características da atuação do parlamentar e o *engajamento mediano* que ele obtém no twitter?

#### Visualização da Correlação Dados
```{r}

dados_ajustados %>% 
    ggplot(aes(x = casa, y = log_engaj_mediano)) +
    labs(title = "Engajamento Mediano pelo Número de Seguidores") +
    geom_count()

dados_ajustados %>% 
    ggplot(aes(x = log_seguidores, y = log_engaj_mediano)) +
    labs(title = "Engajamento Mediano pelo Número de Seguidores") +
    geom_count()

dados_ajustados %>% 
    ggplot(aes(x = log_segue, y = log_engaj_mediano)) +
    labs(title = "Engajamento Mediano pelo Número de Seguidos") +
    geom_count()

dados_ajustados %>% 
    ggplot(aes(x = log_n_proprio, y = log_engaj_mediano)) +
    labs(title = "Engajamento Mediano pelo Número de Tweets") +
    geom_count()

dados_ajustados %>% 
    ggplot(aes(x = log_n_retweet, y = log_engaj_mediano)) +
    labs(title = "Engajamento Mediano pelo Número de Retweets") +
    geom_count()

```

```{r}
modelo_2 <- lm(log_engaj_mediano ~ casa + log_seguidores + log_segue + log_n_proprio + log_n_retweet, data = dados_ajustados)

tidy(modelo_2,
     conf.int = TRUE,
     conf.level = 0.95)
```
#### Análise
Regressão linear múltipla foi utilizada para analisar a associação entre as variávies INDEPENDENTES casa, número de seguidores, número de seguidos, número de tweets e número de retweets com cada variável DEPENDENTE engajamento mediano.

Os resultados da regressão indicam que para o modelo:

##### MODELO 2 :
  engajamento mediano = -1,452 + (casaSENADO x -0,003)  + (seguidores x 0.664) + (segue x -0,302) + (tweets x -0,109) + (retweets x 0,279)

A determinação da *casa*, DECRESCE em 0,003 unidades quando a variável tem valor "SENADO", o valor da VarDep Engajamento Total.

O ganho de 1 *seguidor* produz um ACRÉSCIMO de 0,664 o valor da VarDep Engajamento Total.

*Seguir* um novo usúario produz um DESCRÉSCIMO de 0,302 o valor da VarDep Engajamento Total.

A cada novo *tweet*, existe a diminuição de 0,109 no valor da VarDep Engajamento Total.

A cada novo *retweet*, existe um aumento de 0,279 no valor da VarDep Engajamento Total.

### Considerações

Dado que todas as variáveis foram ajustadas para logarítmo, e foi encontrado uma relação linear entre as variáveis transformadas (log x, log y), significa que as variáveis estão relacionadas polinomialmente. Ou seja, uma delas tem grau diferente de 1 em função da outra.